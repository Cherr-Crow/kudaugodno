# Generated by Django 5.2.4 on 2025-08-05 13:36

import django.contrib.postgres.fields
import django.contrib.postgres.indexes
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name="Category",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Не больше 100 символов",
                        max_length=100,
                        verbose_name="Название",
                    ),
                ),
                (
                    "slug",
                    models.SlugField(
                        blank=True,
                        help_text="Уникальный идентификатор для URL",
                        max_length=100,
                        unique=True,
                        verbose_name="Slug",
                    ),
                ),
            ],
            options={
                "verbose_name": "Категория",
                "verbose_name_plural": "Категории",
                "ordering": ["name"],
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="Tag",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Не больше 100 символов",
                        max_length=100,
                        verbose_name="Название",
                    ),
                ),
                (
                    "slug",
                    models.SlugField(
                        blank=True,
                        help_text="Уникальный идентификатор для URL",
                        max_length=100,
                        unique=True,
                        verbose_name="Slug",
                    ),
                ),
            ],
            options={
                "verbose_name": "Тег",
                "verbose_name_plural": "Теги",
                "ordering": ["name"],
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="Theme",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Не больше 100 символов",
                        max_length=100,
                        verbose_name="Название",
                    ),
                ),
                (
                    "slug",
                    models.SlugField(
                        blank=True,
                        help_text="Уникальный идентификатор для URL",
                        max_length=100,
                        unique=True,
                        verbose_name="Slug",
                    ),
                ),
            ],
            options={
                "verbose_name": "Тема статьи",
                "verbose_name_plural": "Темы статей",
                "ordering": ["name"],
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="Article",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("title", models.CharField(max_length=200, verbose_name="Заголовок")),
                (
                    "slug",
                    models.SlugField(
                        blank=True, max_length=220, unique=True, verbose_name="Slug"
                    ),
                ),
                (
                    "short_description",
                    models.CharField(
                        help_text="Для ленты новостей",
                        max_length=250,
                        verbose_name="Краткое описание",
                    ),
                ),
                (
                    "cover_image",
                    models.ImageField(
                        upload_to="articles/covers/", verbose_name="Обложка"
                    ),
                ),
                (
                    "countries",
                    django.contrib.postgres.fields.ArrayField(
                        base_field=models.CharField(
                            choices=[
                                ("AF", "Афганистан"),
                                ("AX", "Аландские острова"),
                                ("AL", "Албания"),
                                ("DZ", "Алжир"),
                                ("AS", "Американское Самоа"),
                                ("AD", "Андорра"),
                                ("AO", "Ангола"),
                                ("AI", "Ангилья"),
                                ("AQ", "Антарктида"),
                                ("AG", "Антигуа и Барбуда"),
                                ("AR", "Аргентина"),
                                ("AM", "Армения"),
                                ("AW", "Аруба"),
                                ("AU", "Австралия"),
                                ("AT", "Австрия"),
                                ("AZ", "Азербайджан"),
                                ("BS", "Багамы"),
                                ("BH", "Бахрейн"),
                                ("BD", "Бангладеш"),
                                ("BB", "Барбадос"),
                                ("BY", "Беларусь"),
                                ("BE", "Бельгия"),
                                ("BZ", "Белиз"),
                                ("BJ", "Бенин"),
                                ("BM", "Бермуды"),
                                ("BT", "Бутан"),
                                ("BO", "Боливия"),
                                ("BQ", "Бонайре, Синт-Эстатиус и Саба"),
                                ("BA", "Босния и Герцеговина"),
                                ("BW", "Ботсвана"),
                                ("BV", "Остров Буве"),
                                ("BR", "Бразилия"),
                                ("IO", "Британская территория в Индийском океане"),
                                ("BN", "Бруней"),
                                ("BG", "Болгария"),
                                ("BF", "Буркина-Фасо"),
                                ("BI", "Бурунди"),
                                ("CV", "Кабо-Верде"),
                                ("KH", "Камбоджа"),
                                ("CM", "Камерун"),
                                ("CA", "Канада"),
                                ("KY", "Каймановы острова"),
                                ("CF", "ЦАР"),
                                ("TD", "Чад"),
                                ("CL", "Чили"),
                                ("CN", "Китай"),
                                ("CX", "Остров Рождества"),
                                ("CC", "Кокосовые острова"),
                                ("CO", "Колумбия"),
                                ("KM", "Коморы"),
                                ("CG", "Конго"),
                                ("CD", "ДР Конго"),
                                ("CK", "Острова Кука"),
                                ("CR", "Коста-Рика"),
                                ("CI", "Кот-д’Ивуар"),
                                ("HR", "Хорватия"),
                                ("CU", "Куба"),
                                ("CW", "Кюрасао"),
                                ("CY", "Кипр"),
                                ("CZ", "Чехия"),
                                ("DK", "Дания"),
                                ("DJ", "Джибути"),
                                ("DM", "Доминика"),
                                ("DO", "Доминикана"),
                                ("EC", "Эквадор"),
                                ("EG", "Египет"),
                                ("SV", "Сальвадор"),
                                ("GQ", "Экваториальная Гвинея"),
                                ("ER", "Эритрея"),
                                ("EE", "Эстония"),
                                ("SZ", "Эсватини"),
                                ("ET", "Эфиопия"),
                                ("FK", "Фолклендские острова"),
                                ("FO", "Фарерские острова"),
                                ("FJ", "Фиджи"),
                                ("FI", "Финляндия"),
                                ("FR", "Франция"),
                                ("GF", "Французская Гвиана"),
                                ("PF", "Французская Полинезия"),
                                ("TF", "Французские Южные территории"),
                                ("GA", "Габон"),
                                ("GM", "Гамбия"),
                                ("GE", "Грузия"),
                                ("DE", "Германия"),
                                ("GH", "Гана"),
                                ("GI", "Гибралтар"),
                                ("GR", "Греция"),
                                ("GL", "Гренландия"),
                                ("GD", "Гренада"),
                                ("GP", "Гваделупа"),
                                ("GU", "Гуам"),
                                ("GT", "Гватемала"),
                                ("GG", "Гернси"),
                                ("GN", "Гвинея"),
                                ("GW", "Гвинея-Бисау"),
                                ("GY", "Гайана"),
                                ("HT", "Гаити"),
                                ("HM", "Острова Херд и Макдональд"),
                                ("VA", "Ватикан"),
                                ("HN", "Гондурас"),
                                ("HK", "Гонконг"),
                                ("HU", "Венгрия"),
                                ("IS", "Исландия"),
                                ("IN", "Индия"),
                                ("ID", "Индонезия"),
                                ("IR", "Иран"),
                                ("IQ", "Ирак"),
                                ("IE", "Ирландия"),
                                ("IM", "Остров Мэн"),
                                ("IL", "Израиль"),
                                ("IT", "Италия"),
                                ("JM", "Ямайка"),
                                ("JP", "Япония"),
                                ("JE", "Джерси"),
                                ("JO", "Иордания"),
                                ("KZ", "Казахстан"),
                                ("KE", "Кения"),
                                ("KI", "Кирибати"),
                                ("KP", "КНДР"),
                                ("KR", "Корея"),
                                ("KW", "Кувейт"),
                                ("KG", "Киргизия"),
                                ("LA", "Лаос"),
                                ("LV", "Латвия"),
                                ("LB", "Ливан"),
                                ("LS", "Лесото"),
                                ("LR", "Либерия"),
                                ("LY", "Ливия"),
                                ("LI", "Лихтенштейн"),
                                ("LT", "Литва"),
                                ("LU", "Люксембург"),
                                ("MO", "Макао"),
                                ("MG", "Мадагаскар"),
                                ("MW", "Малави"),
                                ("MY", "Малайзия"),
                                ("MV", "Мальдивы"),
                                ("ML", "Мали"),
                                ("MT", "Мальта"),
                                ("MH", "Маршалловы острова"),
                                ("MQ", "Мартиника"),
                                ("MR", "Мавритания"),
                                ("MU", "Маврикий"),
                                ("YT", "Майотта"),
                                ("MX", "Мексика"),
                                ("FM", "Микронезия"),
                                ("MD", "Молдова"),
                                ("MC", "Монако"),
                                ("MN", "Монголия"),
                                ("ME", "Черногория"),
                                ("MS", "Монтсеррат"),
                                ("MA", "Марокко"),
                                ("MZ", "Мозамбик"),
                                ("MM", "Мьянма"),
                                ("NA", "Намибия"),
                                ("NR", "Науру"),
                                ("NP", "Непал"),
                                ("NL", "Нидерланды"),
                                ("NC", "Новая Каледония"),
                                ("NZ", "Новая Зеландия"),
                                ("NI", "Никарагуа"),
                                ("NE", "Нигер"),
                                ("NG", "Нигерия"),
                                ("NU", "Ниуэ"),
                                ("NF", "Остров Норфолк"),
                                ("MK", "Северная Македония"),
                                ("MP", "Северные Марианские острова"),
                                ("NO", "Норвегия"),
                                ("OM", "Оман"),
                                ("PK", "Пакистан"),
                                ("PW", "Палау"),
                                ("PS", "Палестина"),
                                ("PA", "Панама"),
                                ("PG", "Папуа — Новая Гвинея"),
                                ("PY", "Парагвай"),
                                ("PE", "Перу"),
                                ("PH", "Филиппины"),
                                ("PN", "Острова Питкэрн"),
                                ("PL", "Польша"),
                                ("PT", "Португалия"),
                                ("PR", "Пуэрто-Рико"),
                                ("QA", "Катар"),
                                ("RE", "Реюньон"),
                                ("RO", "Румыния"),
                                ("RU", "Россия"),
                                ("RW", "Руанда"),
                                ("BL", "Сен-Бартелеми"),
                                ("SH", "Остров Святой Елены"),
                                ("KN", "Сент-Китс и Невис"),
                                ("LC", "Сент-Люсия"),
                                ("MF", "Сен-Мартен"),
                                ("PM", "Сен-Пьер и Микелон"),
                                ("VC", "Сент-Винсент и Гренадины"),
                                ("WS", "Самоа"),
                                ("SM", "Сан-Марино"),
                                ("ST", "Сан-Томе и Принсипи"),
                                ("SA", "Саудовская Аравия"),
                                ("SN", "Сенегал"),
                                ("RS", "Сербия"),
                                ("SC", "Сейшелы"),
                                ("SL", "Сьерра-Леоне"),
                                ("SG", "Сингапур"),
                                ("SX", "Синт-Мартен"),
                                ("SK", "Словакия"),
                                ("SI", "Словения"),
                                ("SB", "Соломоновы острова"),
                                ("SO", "Сомали"),
                                ("ZA", "ЮАР"),
                                ("GS", "Южная Георгия и Южные Сандвичевы острова"),
                                ("SS", "Южный Судан"),
                                ("ES", "Испания"),
                                ("LK", "Шри-Ланка"),
                                ("SD", "Судан"),
                                ("SR", "Суринам"),
                                ("SJ", "Шпицберген и Ян-Майен"),
                                ("SE", "Швеция"),
                                ("CH", "Швейцария"),
                                ("SY", "Сирия"),
                                ("TW", "Тайвань"),
                                ("TJ", "Таджикистан"),
                                ("TZ", "Танзания"),
                                ("TH", "Таиланд"),
                                ("TL", "Тимор-Лесте"),
                                ("TG", "Того"),
                                ("TK", "Токелау"),
                                ("TO", "Тонга"),
                                ("TT", "Тринидад и Тобаго"),
                                ("TN", "Тунис"),
                                ("TR", "Турция"),
                                ("TM", "Туркменистан"),
                                ("TC", "Острова Тёркс и Кайкос"),
                                ("TV", "Тувалу"),
                                ("UG", "Уганда"),
                                ("UA", "Украина"),
                                ("AE", "ОАЭ"),
                                ("GB", "Великобритания"),
                                ("US", "США"),
                                ("UM", "Малые Тихоокеанские отдаленные острова США"),
                                ("UY", "Уругвай"),
                                ("UZ", "Узбекистан"),
                                ("VU", "Вануату"),
                                ("VE", "Венесуэла"),
                                ("VN", "Вьетнам"),
                                ("VG", "Британские Виргинские острова"),
                                ("VI", "Виргинские острова (США)"),
                                ("WF", "Уоллис и Футуна"),
                                ("EH", "САДР"),
                                ("YE", "Йемен"),
                                ("ZM", "Замбия"),
                                ("ZW", "Зимбабве"),
                            ],
                            max_length=2,
                        ),
                        blank=True,
                        default=list,
                        help_text="Список ISO-кодов стран, например ['RU','TR']",
                        size=None,
                        verbose_name="Страны",
                    ),
                ),
                ("rating", models.FloatField(default=0, verbose_name="Рейтинг статьи")),
                (
                    "meta_title",
                    models.CharField(
                        blank=True,
                        max_length=255,
                        null=True,
                        verbose_name="SEO: заголовок",
                    ),
                ),
                (
                    "meta_description",
                    models.CharField(
                        blank=True,
                        max_length=160,
                        null=True,
                        verbose_name="SEO: описание",
                    ),
                ),
                ("content", models.TextField(verbose_name="Полный текст статьи")),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("draft", "Черновик"),
                            ("on_review", "На модерации"),
                            ("published", "Опубликована"),
                            ("rejected", "Отклонена"),
                        ],
                        default="draft",
                        max_length=15,
                        verbose_name="Статус",
                    ),
                ),
                (
                    "views_count",
                    models.PositiveIntegerField(default=0, verbose_name="Просмотры"),
                ),
                (
                    "created_at",
                    models.DateTimeField(auto_now_add=True, verbose_name="Создано"),
                ),
                (
                    "updated_at",
                    models.DateTimeField(auto_now=True, verbose_name="Обновлено"),
                ),
                (
                    "author",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="articles",
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="Автор",
                    ),
                ),
                (
                    "category",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="articles",
                        to="blogs.category",
                        verbose_name="Категория",
                    ),
                ),
                (
                    "tags",
                    models.ManyToManyField(
                        blank=True, to="blogs.tag", verbose_name="Теги"
                    ),
                ),
                (
                    "theme",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="articles",
                        to="blogs.theme",
                        verbose_name="Тема",
                    ),
                ),
            ],
            options={
                "verbose_name": "Статья",
                "verbose_name_plural": "Статьи",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="Comment",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "text",
                    models.TextField(
                        help_text="Максимум 2000 символов", verbose_name="Текст"
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending", "На модерации"),
                            ("approved", "Одобрен"),
                            ("rejected", "Отклонён"),
                        ],
                        default="pending",
                        max_length=10,
                        verbose_name="Статус модерации",
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(auto_now_add=True, verbose_name="Создан"),
                ),
                (
                    "updated_at",
                    models.DateTimeField(auto_now=True, verbose_name="Обновлён"),
                ),
                (
                    "article",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="comments",
                        to="blogs.article",
                        verbose_name="Статья",
                    ),
                ),
                (
                    "parent",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="children",
                        to="blogs.comment",
                        verbose_name="Родительский комментарий",
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="comments",
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="Автор",
                    ),
                ),
            ],
            options={
                "verbose_name": "Комментарий",
                "verbose_name_plural": "Комментарии",
                "ordering": ["created_at"],
            },
        ),
        migrations.CreateModel(
            name="CommentLike",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "is_like",
                    models.BooleanField(default=True, verbose_name="Лайк / Дизлайк"),
                ),
                (
                    "created_at",
                    models.DateTimeField(auto_now_add=True, verbose_name="Когда"),
                ),
                (
                    "comment",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="likes",
                        to="blogs.comment",
                        verbose_name="Комментарий",
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="Пользователь",
                    ),
                ),
            ],
            options={
                "verbose_name": "Реакция на комментарий",
                "verbose_name_plural": "Реакции на комментарии",
                "unique_together": {("comment", "user")},
            },
        ),
        migrations.CreateModel(
            name="MediaAsset",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "type",
                    models.CharField(
                        choices=[("image", "Фото"), ("video", "Видео")],
                        max_length=10,
                        verbose_name="Тип",
                    ),
                ),
                (
                    "file",
                    models.FileField(upload_to="articles/media/", verbose_name="Файл"),
                ),
                (
                    "order",
                    models.PositiveSmallIntegerField(default=0, verbose_name="Порядок"),
                ),
                (
                    "article",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="media",
                        to="blogs.article",
                        verbose_name="Статья",
                    ),
                ),
            ],
            options={
                "verbose_name": "Медиа-файл",
                "verbose_name_plural": "Медиа-файлы",
                "ordering": ["order"],
                "constraints": [
                    models.UniqueConstraint(
                        fields=("article", "order"),
                        name="unique_media_order_per_article",
                    )
                ],
            },
        ),
        migrations.CreateModel(
            name="Reaction",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(auto_now_add=True, verbose_name="Когда"),
                ),
                (
                    "article",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="reactions",
                        to="blogs.article",
                        verbose_name="Статья",
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="reactions",
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="Пользователь",
                    ),
                ),
            ],
            options={
                "verbose_name": "Лайк",
                "verbose_name_plural": "Лайки",
                "indexes": [
                    models.Index(
                        fields=["article", "-created_at"],
                        name="blogs_react_article_85d640_idx",
                    )
                ],
                "unique_together": {("user", "article")},
            },
        ),
        migrations.AddIndex(
            model_name="article",
            index=models.Index(
                fields=["status", "-created_at"], name="blogs_artic_status_1a1746_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="article",
            index=django.contrib.postgres.indexes.GinIndex(
                fields=["countries"], name="countries_gin"
            ),
        ),
    ]
